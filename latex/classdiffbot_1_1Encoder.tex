\hypertarget{classdiffbot_1_1Encoder}{}\doxysection{diffbot\+::Encoder Class Reference}
\label{classdiffbot_1_1Encoder}\index{diffbot::Encoder@{diffbot::Encoder}}


Decorates the Teensy \mbox{\hyperlink{classdiffbot_1_1Encoder}{Encoder}} Library to read the angular wheel velocity from quadrature wheel encoders.  




{\ttfamily \#include $<$encoder\+\_\+diffbot.\+h$>$}



Collaboration diagram for diffbot\+::Encoder\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=239pt]{classdiffbot_1_1Encoder__coll__graph}
\end{center}
\end{figure}
\doxysubsection*{Public Member Functions}
\begin{DoxyCompactItemize}
\item 
\mbox{\hyperlink{classdiffbot_1_1Encoder_acbda5d37b334d2f8661bdacfbc0118ff}{Encoder}} (ros\+::\+Node\+Handle \&\mbox{\hyperlink{test__encoders_8cpp_a8c8f15207982b3e185f86e1b4968e70d}{nh}}, uint8\+\_\+t pin1, uint8\+\_\+t pin2, int encoder\+\_\+resolution)
\begin{DoxyCompactList}\small\item\em Construct a \mbox{\hyperlink{classdiffbot_1_1Encoder}{diffbot\+::\+Encoder}} providing access to quadrature encoder ticks and angular joint velocity. \end{DoxyCompactList}\item 
int \mbox{\hyperlink{classdiffbot_1_1Encoder_adad42ca061bd943f51efdf8787c42a7c}{get\+R\+PM}} ()
\begin{DoxyCompactList}\small\item\em get revolutions per minute \end{DoxyCompactList}\item 
double \mbox{\hyperlink{classdiffbot_1_1Encoder_a8ff505720e0eead5e9b1720e7f2b16ca}{angular\+Position}} ()
\item 
double \mbox{\hyperlink{classdiffbot_1_1Encoder_a7d074d49a9cd5194b46bbf841b471045}{angular\+Velocity}} ()
\begin{DoxyCompactList}\small\item\em Get the measure the angular joint velocity. \end{DoxyCompactList}\item 
\mbox{\hyperlink{structdiffbot_1_1JointState}{Joint\+State}} \mbox{\hyperlink{classdiffbot_1_1Encoder_aac98f54924f1eff1a377712711f74f6b}{joint\+State}} ()
\item 
double \mbox{\hyperlink{classdiffbot_1_1Encoder_a4a5d7952d6558f3f69a777df49881c75}{ticks\+To\+Angle}} (const int \&ticks) const
\begin{DoxyCompactList}\small\item\em Convert number of encoder ticks to angle in radians. \end{DoxyCompactList}\item 
int32\+\_\+t \mbox{\hyperlink{classdiffbot_1_1Encoder_a2704528ce449123ae97308beb8a1669c}{read}} ()
\begin{DoxyCompactList}\small\item\em Read the current encoder tick count. \end{DoxyCompactList}\item 
void \mbox{\hyperlink{classdiffbot_1_1Encoder_a01b7d5ffe0b6371e7c4794b2519410f5}{write}} (int32\+\_\+t p)
\begin{DoxyCompactList}\small\item\em Set the encoder tick count. \end{DoxyCompactList}\item 
void \mbox{\hyperlink{classdiffbot_1_1Encoder_a93112a0843f0c3eda547bdd7c2fae223}{resolution}} (int resolution)
\begin{DoxyCompactList}\small\item\em Setter for encoder resolution. \end{DoxyCompactList}\item 
int \mbox{\hyperlink{classdiffbot_1_1Encoder_a92008d1e667f5a4960744e4bfd517339}{resolution}} ()
\begin{DoxyCompactList}\small\item\em Getter for encoder resolution. \end{DoxyCompactList}\end{DoxyCompactItemize}
\doxysubsection*{Public Attributes}
\begin{DoxyCompactItemize}
\item 
\+::\mbox{\hyperlink{classdiffbot_1_1Encoder}{Encoder}} \mbox{\hyperlink{classdiffbot_1_1Encoder_acd4e7e8c539dd5b70ba821297f208b6c}{encoder}}
\item 
\mbox{\hyperlink{structdiffbot_1_1JointState}{Joint\+State}} \mbox{\hyperlink{classdiffbot_1_1Encoder_aba56afba5f7e1c22d3eea666560e5d8e}{joint\+\_\+state\+\_\+}}
\end{DoxyCompactItemize}


\doxysubsection{Detailed Description}
Decorates the Teensy \mbox{\hyperlink{classdiffbot_1_1Encoder}{Encoder}} Library to read the angular wheel velocity from quadrature wheel encoders. 

This class is composed of \+::\+Encoder from \href{https://www.pjrc.com/teensy/td_libs_Encoder.html,}{\texttt{ https\+://www.\+pjrc.\+com/teensy/td\+\_\+libs\+\_\+\+Encoder.\+html,}} which is capable of reading rising and falling edges of two Hall effect signals. This yields the highest possible tick count (encoder resolution) from the encoders. Take the D\+G01\+D-\/E motor/encoder, that has a 6 pole magnetic disk (observed with magnetic paper) and therefore 3 pulses per revolution (ppr). Reading both edges (rising and falling) of both channels in the code, we can observe roughly 542 ticks at the wheel output shaft. Because the D\+G01\+D-\/E motor/encoder has a 48\+:1 gear ratio (according to its datasheet) we round the tick count up to 576 counts per wheel revolution). So 576 counts / 48\+:1 gear ratio / 2 channels / 2 edges = 3 pulses per revolution at the motor shaft. Having an encoder with more ppr would increase the encoder resolution. For example let\textquotesingle{}s say we we have an encoder with 7 ppr, then we get the following output resolution at the wheel\+: 7 ppr (at motor shaft) $\ast$ 48\+:1 gear ratio $\ast$ 2 channels $\ast$ 2 edges = 1344 ppr (measured at wheel). 

\doxysubsection{Constructor \& Destructor Documentation}
\mbox{\Hypertarget{classdiffbot_1_1Encoder_acbda5d37b334d2f8661bdacfbc0118ff}\label{classdiffbot_1_1Encoder_acbda5d37b334d2f8661bdacfbc0118ff}} 
\index{diffbot::Encoder@{diffbot::Encoder}!Encoder@{Encoder}}
\index{Encoder@{Encoder}!diffbot::Encoder@{diffbot::Encoder}}
\doxysubsubsection{\texorpdfstring{Encoder()}{Encoder()}}
{\footnotesize\ttfamily diffbot\+::\+Encoder\+::\+Encoder (\begin{DoxyParamCaption}\item[{ros\+::\+Node\+Handle \&}]{nh,  }\item[{uint8\+\_\+t}]{pin1,  }\item[{uint8\+\_\+t}]{pin2,  }\item[{int}]{encoder\+\_\+resolution }\end{DoxyParamCaption})}



Construct a \mbox{\hyperlink{classdiffbot_1_1Encoder}{diffbot\+::\+Encoder}} providing access to quadrature encoder ticks and angular joint velocity. 


\begin{DoxyParams}{Parameters}
{\em nh} & reference to the main ros\+::\+Node\+Handle to compute the velocity from time and ticks or angle (s = v $\ast$ t) \\
\hline
{\em pin1} & Pin of the first Hall effect sensor \\
\hline
{\em pin2} & Pin of the second Hall effect sensor \\
\hline
{\em encoder\+\_\+resolution} & number of tick counts for one full revolution of the wheel (not the motor shaft). Keep track of gear reduction ratio. \\
\hline
\end{DoxyParams}


\doxysubsection{Member Function Documentation}
\mbox{\Hypertarget{classdiffbot_1_1Encoder_a8ff505720e0eead5e9b1720e7f2b16ca}\label{classdiffbot_1_1Encoder_a8ff505720e0eead5e9b1720e7f2b16ca}} 
\index{diffbot::Encoder@{diffbot::Encoder}!angularPosition@{angularPosition}}
\index{angularPosition@{angularPosition}!diffbot::Encoder@{diffbot::Encoder}}
\doxysubsubsection{\texorpdfstring{angularPosition()}{angularPosition()}}
{\footnotesize\ttfamily double diffbot\+::\+Encoder\+::angular\+Position (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})}

\mbox{\Hypertarget{classdiffbot_1_1Encoder_a7d074d49a9cd5194b46bbf841b471045}\label{classdiffbot_1_1Encoder_a7d074d49a9cd5194b46bbf841b471045}} 
\index{diffbot::Encoder@{diffbot::Encoder}!angularVelocity@{angularVelocity}}
\index{angularVelocity@{angularVelocity}!diffbot::Encoder@{diffbot::Encoder}}
\doxysubsubsection{\texorpdfstring{angularVelocity()}{angularVelocity()}}
{\footnotesize\ttfamily double diffbot\+::\+Encoder\+::angular\+Velocity (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})}



Get the measure the angular joint velocity. 

Calculates the angular velocity of the wheel joint using the encoder ticks.

\begin{DoxyReturn}{Returns}
angular wheel joint velocity (rad/s) 
\end{DoxyReturn}
\mbox{\Hypertarget{classdiffbot_1_1Encoder_adad42ca061bd943f51efdf8787c42a7c}\label{classdiffbot_1_1Encoder_adad42ca061bd943f51efdf8787c42a7c}} 
\index{diffbot::Encoder@{diffbot::Encoder}!getRPM@{getRPM}}
\index{getRPM@{getRPM}!diffbot::Encoder@{diffbot::Encoder}}
\doxysubsubsection{\texorpdfstring{getRPM()}{getRPM()}}
{\footnotesize\ttfamily int diffbot\+::\+Encoder\+::get\+R\+PM (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})}



get revolutions per minute 

Calculates the wheels revolution per minute using the encoder ticks.

Based on \href{https://github.com/linorobot/linorobot/blob/53bc4abf150632fbc6c28cdfcc207caa0f81d2b1/teensy/firmware/lib/encoder/Encoder.h}{\texttt{ https\+://github.\+com/linorobot/linorobot/blob/53bc4abf150632fbc6c28cdfcc207caa0f81d2b1/teensy/firmware/lib/encoder/\+Encoder.\+h}}

\begin{DoxyReturn}{Returns}
revolutions per minute 
\end{DoxyReturn}
\mbox{\Hypertarget{classdiffbot_1_1Encoder_aac98f54924f1eff1a377712711f74f6b}\label{classdiffbot_1_1Encoder_aac98f54924f1eff1a377712711f74f6b}} 
\index{diffbot::Encoder@{diffbot::Encoder}!jointState@{jointState}}
\index{jointState@{jointState}!diffbot::Encoder@{diffbot::Encoder}}
\doxysubsubsection{\texorpdfstring{jointState()}{jointState()}}
{\footnotesize\ttfamily \mbox{\hyperlink{structdiffbot_1_1JointState}{diffbot\+::\+Joint\+State}} diffbot\+::\+Encoder\+::joint\+State (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})}

\mbox{\Hypertarget{classdiffbot_1_1Encoder_a2704528ce449123ae97308beb8a1669c}\label{classdiffbot_1_1Encoder_a2704528ce449123ae97308beb8a1669c}} 
\index{diffbot::Encoder@{diffbot::Encoder}!read@{read}}
\index{read@{read}!diffbot::Encoder@{diffbot::Encoder}}
\doxysubsubsection{\texorpdfstring{read()}{read()}}
{\footnotesize\ttfamily int32\+\_\+t diffbot\+::\+Encoder\+::read (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [inline]}}



Read the current encoder tick count. 

\begin{DoxyReturn}{Returns}
encoder ticks 
\end{DoxyReturn}
\mbox{\Hypertarget{classdiffbot_1_1Encoder_a92008d1e667f5a4960744e4bfd517339}\label{classdiffbot_1_1Encoder_a92008d1e667f5a4960744e4bfd517339}} 
\index{diffbot::Encoder@{diffbot::Encoder}!resolution@{resolution}}
\index{resolution@{resolution}!diffbot::Encoder@{diffbot::Encoder}}
\doxysubsubsection{\texorpdfstring{resolution()}{resolution()}\hspace{0.1cm}{\footnotesize\ttfamily [1/2]}}
{\footnotesize\ttfamily int diffbot\+::\+Encoder\+::resolution (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [inline]}}



Getter for encoder resolution. 

Returns the currently set encder resolution. \mbox{\Hypertarget{classdiffbot_1_1Encoder_a93112a0843f0c3eda547bdd7c2fae223}\label{classdiffbot_1_1Encoder_a93112a0843f0c3eda547bdd7c2fae223}} 
\index{diffbot::Encoder@{diffbot::Encoder}!resolution@{resolution}}
\index{resolution@{resolution}!diffbot::Encoder@{diffbot::Encoder}}
\doxysubsubsection{\texorpdfstring{resolution()}{resolution()}\hspace{0.1cm}{\footnotesize\ttfamily [2/2]}}
{\footnotesize\ttfamily void diffbot\+::\+Encoder\+::resolution (\begin{DoxyParamCaption}\item[{int}]{resolution }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [inline]}}



Setter for encoder resolution. 

Used to initialize the encoder with a new resolution, e.\+g. obtained from the R\+OS parameter server.


\begin{DoxyParams}{Parameters}
{\em resolution} & value to which the encoder tick count shoudl be set \\
\hline
\end{DoxyParams}
\mbox{\Hypertarget{classdiffbot_1_1Encoder_a4a5d7952d6558f3f69a777df49881c75}\label{classdiffbot_1_1Encoder_a4a5d7952d6558f3f69a777df49881c75}} 
\index{diffbot::Encoder@{diffbot::Encoder}!ticksToAngle@{ticksToAngle}}
\index{ticksToAngle@{ticksToAngle}!diffbot::Encoder@{diffbot::Encoder}}
\doxysubsubsection{\texorpdfstring{ticksToAngle()}{ticksToAngle()}}
{\footnotesize\ttfamily double diffbot\+::\+Encoder\+::ticks\+To\+Angle (\begin{DoxyParamCaption}\item[{const int \&}]{ticks }\end{DoxyParamCaption}) const}



Convert number of encoder ticks to angle in radians. 

Calculates the current tick count of the encoder to its absolute angle in radians using the encoder\+\_\+resolution\+\_\+.


\begin{DoxyParams}{Parameters}
{\em ticks} & tick count from an encoder which is converted to a corresponding absolute angle.\\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
angle corresponding to encoder ticks (rad) 
\end{DoxyReturn}
\mbox{\Hypertarget{classdiffbot_1_1Encoder_a01b7d5ffe0b6371e7c4794b2519410f5}\label{classdiffbot_1_1Encoder_a01b7d5ffe0b6371e7c4794b2519410f5}} 
\index{diffbot::Encoder@{diffbot::Encoder}!write@{write}}
\index{write@{write}!diffbot::Encoder@{diffbot::Encoder}}
\doxysubsubsection{\texorpdfstring{write()}{write()}}
{\footnotesize\ttfamily void diffbot\+::\+Encoder\+::write (\begin{DoxyParamCaption}\item[{int32\+\_\+t}]{p }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [inline]}}



Set the encoder tick count. 

Mainly used to reset the encoder back to zero.


\begin{DoxyParams}{Parameters}
{\em p} & encoder ticks \\
\hline
\end{DoxyParams}


\doxysubsection{Member Data Documentation}
\mbox{\Hypertarget{classdiffbot_1_1Encoder_acd4e7e8c539dd5b70ba821297f208b6c}\label{classdiffbot_1_1Encoder_acd4e7e8c539dd5b70ba821297f208b6c}} 
\index{diffbot::Encoder@{diffbot::Encoder}!encoder@{encoder}}
\index{encoder@{encoder}!diffbot::Encoder@{diffbot::Encoder}}
\doxysubsubsection{\texorpdfstring{encoder}{encoder}}
{\footnotesize\ttfamily \+::\mbox{\hyperlink{classdiffbot_1_1Encoder}{Encoder}} diffbot\+::\+Encoder\+::encoder}

\mbox{\Hypertarget{classdiffbot_1_1Encoder_aba56afba5f7e1c22d3eea666560e5d8e}\label{classdiffbot_1_1Encoder_aba56afba5f7e1c22d3eea666560e5d8e}} 
\index{diffbot::Encoder@{diffbot::Encoder}!joint\_state\_@{joint\_state\_}}
\index{joint\_state\_@{joint\_state\_}!diffbot::Encoder@{diffbot::Encoder}}
\doxysubsubsection{\texorpdfstring{joint\_state\_}{joint\_state\_}}
{\footnotesize\ttfamily \mbox{\hyperlink{structdiffbot_1_1JointState}{Joint\+State}} diffbot\+::\+Encoder\+::joint\+\_\+state\+\_\+}



The documentation for this class was generated from the following files\+:\begin{DoxyCompactItemize}
\item 
diffbot\+\_\+base/scripts/base\+\_\+controller/lib/encoder/\mbox{\hyperlink{encoder__diffbot_8h}{encoder\+\_\+diffbot.\+h}}\item 
diffbot\+\_\+base/scripts/base\+\_\+controller/lib/encoder/\mbox{\hyperlink{encoder__diffbot_8cpp}{encoder\+\_\+diffbot.\+cpp}}\end{DoxyCompactItemize}
